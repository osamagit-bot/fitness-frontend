import{j as e}from"./ui-D95r1dMF.js";import{r as t}from"./vendor-iz3JPVmO.js";import{L as s,m as a,F as r,c as i,d as l,e as n,h as o,i as d,j as c,k as m,l as x,n as h,a as p,y as u}from"./index-CoDTQVyW.js";import"./utils-CCtIn9I6.js";import"./router-D8KzWLZn.js";function b(){const b=localStorage.getItem("admin_access_token"),[g,y]=t.useState(!1),[f,j]=t.useState({email:!1,whatsapp:!1,app:!0,memberAlerts:!0,systemUpdates:!1}),[w,N]=t.useState(!1),[v,k]=t.useState(!1),[_,C]=t.useState([]),[S,A]=t.useState(""),[$,B]=t.useState(!0),[z,D]=t.useState(!1),[M,R]=t.useState(null),[T,E]=t.useState(!1),[F,P]=t.useState(""),[W,L]=t.useState(!1),[U,I]=t.useState(null),[H,O]=t.useState(""),[K,G]=t.useState(!1),[V,Y]=t.useState([]),[q,J]=t.useState(!1),[Q,X]=t.useState(null),[Z,ee]=t.useState(!1),[te,se]=t.useState(null),[ae,re]=t.useState(!1),ie=async()=>{const e=z?D:B;e(!0);try{const e=await p.get("members/",{headers:{Authorization:`Bearer ${b}`}}),t=e.data.results||e.data;C(t),z&&u.success("Member list refreshed!")}catch(t){u.error("Failed to load members"),C([])}finally{e(!1)}};t.useEffect((()=>{ie()}),[b]);const le=_.filter((e=>[e.first_name,e.last_name,e.email,e.phone,e.username,e.athlete_id,e.id].join(" ").toLowerCase().includes(S.toLowerCase())));function ne(e=12){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let s="";for(let a=0;a<e;a++)s+=t.charAt(Math.floor(70*Math.random()));return s}t.useEffect((()=>{(async()=>{if(b)try{await(async()=>{try{const e=await p.get("/get_global_notification_settings/",{headers:{Authorization:`Bearer ${b}`}});j((t=>({...t,email:e.data.email_notifications_enabled||!1,whatsapp:e.data.whatsapp_notifications_enabled||!1})))}catch(e){j((e=>({...e,email:!1,whatsapp:!1})))}})();try{const e=await p.get("/admin-dashboard/maintenance-mode/",{headers:{Authorization:`Bearer ${b}`}});N(e.data.enabled||!1)}catch(e){N(!1)}}catch(e){}finally{k(!0)}})()}),[b]);const oe=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-800 via-gray-800 to-black",children:[e.jsx(s,{position:"top-right",autoClose:5e3}),e.jsxs(a.div,{className:"container mx-auto px-4 py-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},children:[e.jsxs(a.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.1,duration:.5},className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-300",children:"Manage member accounts and system settings"})]}),e.jsxs("button",{onClick:()=>{localStorage.clear(),window.location.href="/login"},className:"mt-4 md:mt-0 flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black rounded-lg transition-all duration-300",children:[e.jsx(r,{})," Logout"]})]}),e.jsxs(a.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"bg-gray-700 rounded-xl shadow-md overflow-hidden mb-8 border border-gray-600",children:[e.jsx("div",{className:"p-6 border-b border-gray-600",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Member Credentials"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{A(""),D(!0),ie()},className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black rounded-lg transition-all duration-300",disabled:z,children:[e.jsx(i,{className:z?"animate-spin":""}),e.jsx("span",{children:"Refresh"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",className:"pl-10 pr-4 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 bg-gray-800 text-white placeholder-gray-400 w-full md:w-64",placeholder:"Search members...",value:S,onChange:e=>A(e.target.value)})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Member"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Membership"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold text-white uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-700 divide-y divide-gray-600",children:$?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):0===le.length?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-300",children:S?"No matching members found":"No members available"})}):le.map((t=>{var s,a;const r=(e=>{if(!e)return!1;const t=new Date;t.setHours(0,0,0,0);const s=new Date(e);return s.setHours(0,0,0,0),s<t})(t.expiry_date),i=(e=>{if(!e)return!1;const t=new Date;t.setHours(0,0,0,0);const s=new Date(e);return s.setHours(0,0,0,0),!(s<t)&&Math.ceil((s-t)/864e5)<=7})(t.expiry_date),l=(e=>{if(!e)return 0;const t=new Date;t.setHours(0,0,0,0);const s=new Date(e);return s.setHours(0,0,0,0),Math.ceil((s-t)/864e5)})(t.expiry_date),d=t.athlete_id||t.id;return e.jsxs("tr",{className:`\n                          ${r?"bg-red-900/20":""}\n                          ${i?"bg-yellow-900/20":""}\n                          hover:bg-gray-600\n                        `,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:d}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-medium",children:[null==(s=t.first_name)?void 0:s.charAt(0),null==(a=t.last_name)?void 0:a.charAt(0)]}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium "+(r?"text-red-400":"text-white"),children:[t.first_name," ",t.last_name]}),e.jsxs("div",{className:"text-sm text-gray-300",children:["@",t.username||"no-username"]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-white",children:t.email}),e.jsx("div",{className:"text-sm text-gray-300",children:t.phone||"No phone"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-white",children:t.membership_type||"None"}),e.jsx("div",{className:"text-sm text-gray-300",children:t.expiry_date?oe(t.expiry_date):"No expiry"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r?e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:[e.jsx(n,{className:"mr-1"})," Expired"]}):i?e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Expires in ",l," days"]}):e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:[e.jsx(o,{className:"mr-1"})," Active"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>(e=>{I(e),L(!0),O("")})(d),disabled:T&&M===d,className:"px-4 py-2 rounded-md text-white "+(T&&M===d?"bg-blue-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"),children:T&&M===d?"Resetting...":"Reset Password"})})]},d)}))})]})})]}),e.jsxs(a.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-600",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Notification Preferences"})}),e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-600 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Receive important updates via email"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:!!v&&f.email,onChange:async()=>{try{const e=await p.post("/set_global_notification_settings/",{email_notifications_enabled:!f.email},{headers:{Authorization:`Bearer ${b}`}});j((t=>({...t,email:e.data.email_notifications_enabled}))),u.success("Email notification setting updated!")}catch(e){u.error("Failed to update email notification setting")}},disabled:!v}),e.jsx("div",{className:"w-11 h-6 bg-gray-500 border border-gray-400 rounded-full peer peer-checked:bg-yellow-500 peer-checked:border-yellow-400 transition-colors "+(v?"":"opacity-50")}),e.jsx("div",{className:"absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5 shadow-sm"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-600 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:"WhatsApp Notifications"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Receive important updates via WhatsApp"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:!!v&&f.whatsapp,onChange:async()=>{try{const e=await p.post("/set_global_notification_settings/",{whatsapp_notifications_enabled:!f.whatsapp},{headers:{Authorization:`Bearer ${b}`}});j((t=>({...t,whatsapp:e.data.whatsapp_notifications_enabled}))),u.success("WhatsApp notification setting updated!")}catch(e){u.error("Failed to update WhatsApp notification setting")}},disabled:!v}),e.jsx("div",{className:"w-11 h-6 bg-gray-500 border border-gray-400 rounded-full peer peer-checked:bg-yellow-500 peer-checked:border-yellow-400 transition-colors "+(v?"":"opacity-50")}),e.jsx("div",{className:"absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5 shadow-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 px-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-300 text-center",children:"Email Tests"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{y(!0);try{(await p.post("notifications/test_email_system/",{},{headers:{Authorization:`Bearer ${b}`}})).data.email_sent?u.success("âœ… Email system test passed! Check your email."):u.warning("âš ï¸ Email configured but sending failed. Check console.")}catch(e){u.error("âŒ Email system test failed")}finally{y(!1)}},disabled:g,className:"flex-1 px-3 py-2 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:g?"Testing...":"System Test"}),e.jsx("button",{onClick:async()=>{y(!0);try{await p.post("notifications/test_email_notification/",{},{headers:{Authorization:`Bearer ${b}`}}),u.success("Test email sent successfully!")}catch(e){u.error("Failed to send test email")}finally{y(!1)}},disabled:g,className:"flex-1 px-3 py-2 text-xs bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:g?"Sending...":"Send Test"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-300 text-center",children:"WhatsApp Tests"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{y(!0);try{(await p.post("notifications/test_whatsapp_system/",{},{headers:{Authorization:`Bearer ${b}`}})).data.whatsapp_sent?u.success("âœ… WhatsApp system test passed! Check your phone."):u.warning("âš ï¸ WhatsApp configured but sending failed. Check console.")}catch(e){u.error("âŒ WhatsApp system test failed")}finally{y(!1)}},disabled:g,className:"flex-1 px-3 py-2 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:g?"Testing...":"System Test"}),e.jsx("button",{onClick:async()=>{y(!0);try{await p.post("notifications/test_whatsapp_notification/",{},{headers:{Authorization:`Bearer ${b}`}}),u.success("Test WhatsApp message sent successfully!")}catch(e){u.error("Failed to send test WhatsApp message")}finally{y(!1)}},disabled:g,className:"flex-1 px-3 py-2 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:g?"Sending...":"Send Test"})]})]})]})]})})]}),e.jsxs("div",{className:"bg-gray-700 rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-600",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:"System Settings"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ðŸ—„ï¸ Database Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("button",{onClick:async()=>{y(!0);try{const e=await p.post("/backup-database/",{},{headers:{Authorization:`Bearer ${b}`}});e.data.success?u.success(`âœ… ${e.data.message}\nðŸ“ ${e.data.details.filename}\nðŸ“Š ${e.data.details.records} records (${e.data.details.size_kb} KB)`):u.error(`âŒ ${e.data.message}`)}catch(e){u.error("âŒ Backup system failed")}finally{y(!1)}},disabled:g,className:"px-6 py-4 text-white rounded-lg transition-all duration-300 transform hover:scale-105 "+(g?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 shadow-lg hover:shadow-xl"),children:e.jsx("div",{className:"flex items-center justify-center gap-3",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{className:"font-semibold",children:"Creating Backup..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xl",children:"ðŸ’¾"}),e.jsx("span",{className:"font-semibold text-lg",children:"Backup Database"})]})})}),e.jsx("button",{onClick:async()=>{await(async()=>{try{const e=await p.get("/list-backups/",{headers:{Authorization:`Bearer ${b}`}});e.data.success&&Y(e.data.backups)}catch(e){u.error("Failed to load backup files")}})(),J(!0)},disabled:g||Z,className:"px-6 py-4 text-white rounded-lg transition-all duration-300 transform hover:scale-105 "+(g||Z?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 shadow-lg hover:shadow-xl"),children:e.jsx("div",{className:"flex items-center justify-center gap-3",children:Z?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{className:"font-semibold",children:"Restoring..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xl",children:"ðŸ”„"}),e.jsx("span",{className:"font-semibold text-lg",children:"Restore Database"})]})})})]}),e.jsx("p",{className:"text-sm text-gray-300 mt-3 text-center",children:"Create secure backups and restore from previous states. Emergency backup is created automatically before restore."})]}),q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4 border border-gray-600",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"âš ï¸ Restore Database"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-red-800 text-sm",children:[e.jsx("strong",{children:"Warning:"})," This will replace your current database with the selected backup. An emergency backup will be created automatically."]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Select Backup File:"}),e.jsxs("select",{value:(null==Q?void 0:Q.filename)||"",onChange:e=>{const t=V.find((t=>t.filename===e.target.value));X(t),se(null),t&&(async e=>{re(!0);try{const t=await p.get(`/inspect-backup/?filename=${e}`,{headers:{Authorization:`Bearer ${b}`}});t.data.success&&se(t.data)}catch(t){u.error("Failed to inspect backup file")}finally{re(!1)}})(t.filename)},className:"w-full p-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 bg-gray-700 text-white",children:[e.jsx("option",{value:"",children:"Choose a backup..."}),V.map((t=>e.jsxs("option",{value:t.filename,children:[t.created," (",t.size_kb," KB)"]},t.filename)))]})]}),ae&&e.jsx("div",{className:"mb-4 p-3 bg-blue-900/30 border border-blue-500/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-400"}),e.jsx("span",{className:"text-sm text-blue-300",children:"Inspecting backup..."})]})}),te&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-700 border border-gray-600 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-white mb-2",children:"ðŸ“‹ Backup Contents:"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsxs("div",{children:["ðŸ“Š Total Records: ",te.total_records]}),e.jsxs("div",{children:["ðŸ‘¥ Users: ",te.model_counts["Authentication.customuser"]||0]}),e.jsxs("div",{children:["ðŸƒ Members: ",te.model_counts["Member.member"]||0]}),e.jsxs("div",{children:["ðŸ’ª Trainers: ",te.model_counts["Member.trainer"]||0]}),te.members.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"font-medium text-white",children:"Members in this backup:"}),e.jsx("div",{className:"max-h-20 overflow-y-auto text-xs",children:te.members.map(((t,s)=>e.jsxs("div",{className:"text-gray-400",children:["ID: ",t.pk,", User: ",t.user_id,", Type: ",t.membership_type]},s)))})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{J(!1),X(null)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(Q){ee(!0),J(!1);try{const e=await p.post("/restore-database/",{backup_filename:Q.filename},{headers:{Authorization:`Bearer ${b}`}});e.data.success?(u.success(`âœ… ${e.data.message}\nðŸ“ Restored from: ${e.data.details.restored_from}\nðŸ“Š ${e.data.details.records_restored} records restored\nðŸ›¡ï¸ Emergency backup: ${e.data.details.emergency_backup}`),setTimeout((()=>{window.location.reload()}),3e3)):u.error(`âŒ ${e.data.message}`)}catch(e){u.error("âŒ Database restore failed")}finally{ee(!1),X(null)}}},disabled:!Q,className:"flex-1 px-4 py-2 text-white rounded-lg transition "+(Q?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800":"bg-gray-500 cursor-not-allowed"),children:"Restore Now"})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Maintenance Mode"}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-600 rounded-lg",children:[e.jsx("p",{className:"text-white",children:"Enable maintenance mode"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:!!v&&w,onChange:async()=>{y(!0);const e=!w;try{await p.post("/admin-dashboard/maintenance-mode/",{enabled:e},{headers:{Authorization:`Bearer ${b}`}});N(e),u.success("Maintenance mode "+(e?"enabled":"disabled"))}catch(t){u.error("Failed to toggle maintenance mode")}finally{y(!1)}},disabled:g||!v}),e.jsx("div",{className:"w-11 h-6 bg-gray-500 border border-gray-400 rounded-full peer peer-checked:bg-yellow-500 peer-checked:border-yellow-400 transition "+(g||!v?"opacity-50":"")}),e.jsx("div",{className:"absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition peer-checked:translate-x-5"})]})]}),e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"When enabled, only admins can access the system."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Data Export"}),e.jsx("button",{onClick:async()=>{y(!0);try{const e=await p.get("/admin-dashboard/export-members/",{headers:{Authorization:`Bearer ${b}`},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=t,s.setAttribute("download",`members_export_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(t),u.success("Member data exported successfully!")}catch(e){u.error("Failed to export member data")}finally{y(!1)}},disabled:g,className:"w-full px-4 py-3 text-white rounded-lg transition "+(g?"bg-green-400 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800"),children:g?"Exporting...":"Export All Member Data"}),e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"Download a CSV file with all member information."})]})]})]})]})]}),e.jsx(d,{children:W&&e.jsx(a.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(a.div,{className:"bg-gray-800 rounded-xl w-full max-w-md border border-gray-600",initial:{scale:.9,y:40},animate:{scale:1,y:0},exit:{scale:.9,y:40},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Reset Member Password"}),e.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-200",children:e.jsx(c,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-300",children:["You are about to reset the password for member ID:"," ",e.jsx("span",{className:"font-bold text-white",children:U})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-1",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:K?"text":"password",className:"w-full px-4 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 bg-gray-700 text-white placeholder-gray-400",placeholder:"Enter new password",value:H,onChange:e=>O(e.target.value)}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-200",onClick:()=>G(!K),children:K?e.jsx(m,{}):e.jsx(x,{})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"showPassword",checked:K,onChange:()=>G(!K),className:"mr-2"}),e.jsx("label",{htmlFor:"showPassword",className:"text-sm text-gray-300",children:"Show password"})]}),e.jsx("button",{type:"button",className:"text-sm bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-3 py-1 rounded",onClick:()=>O(ne()),children:"Generate Random"})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{className:"px-4 py-2 border border-gray-600 rounded-lg text-white hover:bg-gray-600 transition",onClick:()=>L(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-lg text-white transition "+(T?"bg-blue-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"),onClick:async()=>{var e,t;const s=U,a=H||ne();E(!0),L(!1);try{await p.post("members/reset_password/",{member_id:s,new_password:a},{headers:{Authorization:`Bearer ${b}`}}),P(a),R(s),u.success("Password reset successfully!")}catch(r){u.error(`Failed to reset password: ${(null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.detail)||r.message}`)}finally{E(!1),I(null),O("")}},disabled:T,children:T?"Processing...":"Confirm Reset"})]})]})]})})})}),e.jsx(d,{children:M&&F&&e.jsx(a.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(a.div,{className:"bg-gray-800 rounded-xl w-full max-w-md border border-gray-600",initial:{scale:.9,y:40},animate:{scale:1,y:0},exit:{scale:.9,y:40},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-green-400",children:"Password Reset Complete"}),e.jsx("button",{onClick:()=>{R(null),P("")},className:"text-gray-400 hover:text-gray-200",children:e.jsx(c,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-300",children:["The password for member ID"," ",e.jsx("span",{className:"font-bold text-white",children:M})," has been successfully reset."]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-white",children:"New Password:"}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(F),u.success("Password copied to clipboard!")},className:"flex items-center gap-1 text-blue-400 hover:text-blue-300",children:[e.jsx(h,{})," Copy"]})]}),e.jsx("div",{className:"font-mono text-lg bg-gray-800 text-white p-2 rounded border border-gray-600 select-all",children:F}),e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"Please provide this password to the member securely."})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all duration-300",onClick:()=>{R(null),P("")},children:"Close"})})]})]})})})})]})}export{b as default};
