import{j as e}from"./ui-D95r1dMF.js";import{r as t}from"./vendor-iz3JPVmO.js";import{f as a,g as s,b as n,A as l,a as r,s as i}from"./index-CoDTQVyW.js";import"./utils-CCtIn9I6.js";import"./router-D8KzWLZn.js";function d(){const[d,c]=t.useState([]),[o,m]=t.useState([]),[h,x]=t.useState([]),[u,g]=t.useState("announcements"),[p,y]=t.useState(!1),[b,j]=t.useState(null),[v,N]=t.useState({title:"",content:""}),[w,f]=t.useState({title:"",description:"",startDate:"",endDate:""});t.useEffect((()=>{(async()=>{y(!0);try{try{const e=await r.get("admin-community/announcements/");m(e.data)}catch(e){}try{const e=await r.get("admin-community/challenges/");x(e.data)}catch(e){}try{const e=await r.get("admin-community/community_posts/");c(e.data)}catch(e){}y(!1)}catch(e){j("Some community management features are currently unavailable."),y(!1)}})()}),[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container mx-auto p-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Community Management"}),e.jsx("p",{className:"text-gray-300",children:"Create and manage community content for members."}),b&&e.jsx("p",{className:"mt-2 text-red-500",children:b})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"flex space-x-8",children:["announcements","challenges","posts"].map((t=>e.jsx("button",{onClick:()=>g(t),className:"py-4 px-1 border-b-2 font-medium text-sm "+(u===t?"border-yellow-500 text-yellow-500":"border-transparent text-gray-300 hover:text-white hover:border-gray-500"),children:t.charAt(0).toUpperCase()+t.slice(1)},t)))})}),"announcements"===u&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Create New Announcement"}),e.jsxs("form",{onSubmit:async e=>{var t,a;if(e.preventDefault(),v.title.trim()&&v.content.trim())try{const e=await r.post("admin-community/create_announcement/",v);m([e.data,...o]),N({title:"",content:""}),i.success("Announcement created successfully!")}catch(s){const e=(null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.detail)||"Failed to create announcement.";i.error(e)}else i.warn("Please fill in both title and content")},children:[e.jsx("input",{type:"text",placeholder:"Title",className:"w-full mb-4 p-2 border border-gray-600 rounded bg-gray-800 text-white placeholder-gray-400",value:v.title,onChange:e=>N({...v,title:e.target.value})}),e.jsx("textarea",{placeholder:"Content",className:"w-full mb-4 p-2 border border-gray-600 rounded bg-gray-800 text-white placeholder-gray-400",value:v.content,onChange:e=>N({...v,content:e.target.value})}),e.jsx("button",{type:"submit",className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-black px-4 py-2 rounded hover:from-yellow-600 hover:to-yellow-700 transition-all duration-300",children:"Post Announcement"})]})]}),e.jsx("div",{className:"space-y-4",children:p?e.jsx("p",{children:"Loading..."}):o.length>0?o.map((t=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded shadow relative",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.title}),e.jsx("p",{className:"text-gray-300",children:t.content}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Posted on ",a(s(t))]}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this announcement?"))try{await r.delete(`admin-community/${e}/delete_announcement/`),m(o.filter((t=>t.id!==e)))}catch(t){i.error("Failed to delete announcement.")}})(t.id),className:"absolute top-2 right-2 text-red-500 hover:underline text-sm",children:"Delete"})]},t.id))):e.jsx("p",{children:"No announcements available."})})]}),"challenges"===u&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Create New Challenge"}),e.jsxs("form",{onSubmit:async e=>{var t,a;if(e.preventDefault(),!(w.title&&w.description&&w.startDate&&w.endDate))return void i.warn("Please fill in all challenge fields");const s={title:w.title,description:w.description,start_date:w.startDate,end_date:w.endDate};try{const e=await r.post("admin-community/create_challenge/",s);x([e.data,...h]),f({title:"",description:"",startDate:"",endDate:""}),i.success("Challenge created successfully!")}catch(n){const e=(null==(a=null==(t=n.response)?void 0:t.data)?void 0:a.detail)||"Failed to create challenge.";i.error(e)}},children:[e.jsx("input",{type:"text",placeholder:"Title",className:"w-full mb-4 p-2 border border-gray-600 rounded bg-gray-800 text-white placeholder-gray-400",value:w.title,onChange:e=>f({...w,title:e.target.value})}),e.jsx("textarea",{placeholder:"Description",className:"w-full mb-4 p-2 border border-gray-600 rounded bg-gray-800 text-white placeholder-gray-400",value:w.description,onChange:e=>f({...w,description:e.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsx("input",{type:"date",className:"p-2 border border-gray-600 rounded bg-gray-800 text-white",value:w.startDate,onChange:e=>f({...w,startDate:e.target.value})}),e.jsx("input",{type:"date",className:"p-2 border border-gray-600 rounded bg-gray-800 text-white",value:w.endDate,onChange:e=>f({...w,endDate:e.target.value})})]}),e.jsx("button",{type:"submit",className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-black px-4 py-2 rounded hover:from-yellow-600 hover:to-yellow-700 transition-all duration-300",children:"Create Challenge"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p?e.jsx("p",{children:"Loading..."}):h.length>0?h.map((t=>e.jsxs("div",{className:"bg-gray-700 rounded shadow p-4 relative",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.title}),e.jsx("p",{className:"mb-2 text-gray-300",children:t.description}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("p",{children:["Participants: ",t.participants||0]}),e.jsxs("p",{children:["Ends: ",t.end_date?new Date(t.end_date).toLocaleDateString():"No end date"]})]}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this challenge?"))try{await r.delete(`admin-community/${e}/delete_challenge/`),x(h.filter((t=>t.id!==e)))}catch(t){i.error("Failed to delete challenge.")}})(t.id),className:"absolute top-2 right-2 text-red-500 hover:underline text-sm",children:"Delete"})]},t.id))):e.jsx("p",{children:"No challenges available."})})]}),"posts"===u&&e.jsx("div",{className:"space-y-4",children:p?e.jsx("p",{children:"Loading..."}):d.length>0?d.map((t=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded shadow border border-gray-600",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:t.title}),e.jsx("p",{className:"text-gray-300 mt-2",children:t.content})]})}),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[e.jsxs("p",{children:["Posted by ",e.jsx("span",{className:"font-medium",children:t.author||"Unknown"})," on"," ",a(s(t))]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ‘ ",t.likes||0," likes"]}),e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ’¬ ",t.comments||0," comments"]})]})]})}),t.comments_list&&t.comments_list.length>0&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"font-semibold text-white mb-3",children:"Comments:"}),e.jsx("div",{className:"space-y-3",children:t.comments_list.map(((t,a)=>e.jsxs("div",{className:"bg-gray-600 p-3 rounded-lg border border-gray-500",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-sm text-white",children:t.author||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-400",children:n(s(t))})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:t.content})]},a)))})]})]},t.id))):e.jsx("p",{children:"No member posts yet."})})]}),e.jsx(l,{})]})}export{d as default};
