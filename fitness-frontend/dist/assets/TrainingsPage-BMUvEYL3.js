import{j as e}from"./ui-D95r1dMF.js";import{r as t}from"./vendor-iz3JPVmO.js";import{a as s,A as a,s as r}from"./index-CoDTQVyW.js";import"./utils-CCtIn9I6.js";import"./router-D8KzWLZn.js";function i(){const[i,l]=t.useState([]),[n,d]=t.useState([]),[o,c]=t.useState(!1),[m,x]=t.useState(null),[h,p]=t.useState(!1),[u,g]=t.useState({type:"",trainer:"",date:"",time:"",duration:"",capacity:"",description:"",image:null}),[y,b]=t.useState(new Set),w=e=>{b((t=>new Set([...t,e])))},j=e=>{if(!e.image)return"/images/default-training.png";if(e.image.startsWith("http"))return e.image;return`${"https://your-production-domain.com/api/".replace("/api","")}${e.image}`};t.useEffect((()=>{N(),f()}),[]);const f=async()=>{try{const e=localStorage.getItem("access_token"),t=await s.get("trainers/",{headers:{Authorization:`Bearer ${e}`}}),a=t.data.results||t.data;Array.isArray(a)&&a.length>0?d(a):x("No trainers available. Please add trainers first.")}catch(e){e.response&&405===e.response.status?x("Trainers API not available. Please navigate to Trainers page to add trainers first."):x("Failed to load trainers. Please try again later.")}},N=async()=>{c(!0),x(null);try{const e=localStorage.getItem("access_token"),t=await s.get("trainings/",{headers:{Authorization:`Bearer ${e}`}}),a=t.data.results||t.data;l(Array.isArray(a)?a:[])}catch(e){x("Failed to load training sessions")}finally{c(!1)}},v=e=>{const{name:t,value:s}=e.target;g({...u,[t]:s})},k=async e=>{if(window.confirm("Are you sure you want to cancel this training session?"))try{const t=localStorage.getItem("access_token");await s.delete(`trainings/${e}/`,{headers:{Authorization:`Bearer ${t}`}}),l(i.filter((t=>t.id!==e))),r.success("Training session cancelled successfully!")}catch(t){r.error("Failed to cancel training session")}},S=e=>{if(!e)return"—";return new Date(e).toLocaleString()},T=e=>{if(!e)return"—";const t=Math.floor(e/60),s=e%60;return t>0?`${t}h ${s}m`:`${s} min`},C=()=>{p(!1),g({type:"",trainer:"",date:"",time:"",duration:"",capacity:"",description:"",image:null})};return e.jsxs(e.Fragment,{children:[e.jsx(a,{}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-800 via-gray-800 to-black p-2 md:p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-2",children:"Training Management"}),e.jsx("div",{className:"w-24 h-1 bg-yellow-500 mx-auto rounded-full"}),e.jsx("p",{className:"text-gray-300 mt-4",children:"Schedule and manage training sessions"})]}),m&&e.jsxs("div",{className:"mb-4 p-3 bg-red-900/30 text-red-300 rounded-xl border border-red-500/50",children:[e.jsx("p",{className:"font-semibold",children:"Error"}),e.jsx("p",{className:"text-sm md:text-base whitespace-pre-line",children:m})]}),h&&e.jsxs("div",{className:"bg-gray-700 rounded-2xl shadow-xl border border-gray-600 mb-8 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-black",children:"Schedule New Training"}),e.jsx("button",{onClick:C,className:"text-black hover:text-gray-700 transition-colors",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),c(!0),x(null);try{const e=localStorage.getItem("access_token"),t=new FormData;t.append("trainer",parseInt(u.trainer)),t.append("type",u.type);const a=new Date(`${u.date}T${u.time}:00`);t.append("datetime",a.toISOString()),t.append("duration",parseInt(u.duration)),t.append("capacity",parseInt(u.capacity)),t.append("description",u.description||""),u.image&&t.append("image",u.image);await s.post("trainings/",t,{headers:{Authorization:`Bearer ${e}`},timeout:1e4});g({type:"",trainer:"",date:"",time:"",duration:"",capacity:"",description:"",image:null}),p(!1),N(),r.success("Training scheduled successfully!")}catch(t){if(t.response)if(t.response.data&&"object"==typeof t.response.data){const e=Object.entries(t.response.data).map((([e,t])=>`${e}: ${Array.isArray(t)?t.join(", "):t}`)).join("\n");x(`Failed to schedule training session:\n${e}`)}else x("Failed to schedule training session: "+(t.response.data||t.message));else x("Failed to schedule training session: "+t.message)}finally{c(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Training Type"}),e.jsxs("select",{name:"type",value:u.type,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select a type"}),[{value:"fitness",label:"Fitness"},{value:"yoga",label:"Yoga"},{value:"cardio",label:"Cardio"},{value:"strength",label:"Strength Training"},{value:"nutrition",label:"Nutrition"}].map((t=>e.jsx("option",{value:t.value,children:t.label},t.value)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Trainer"}),e.jsxs("select",{name:"trainer",value:u.trainer,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select a trainer"}),n.map((t=>e.jsxs("option",{value:t.id,children:[t.first_name," ",t.last_name]},t.id)))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:u.date,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Time"}),e.jsx("input",{type:"time",name:"time",value:u.time,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Duration (minutes)"}),e.jsx("input",{type:"number",name:"duration",value:u.duration,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0,min:"1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Capacity (people)"}),e.jsx("input",{type:"number",name:"capacity",value:u.capacity,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white",required:!0,min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Description (Optional)"}),e.jsx("textarea",{name:"description",value:u.description,onChange:v,className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white placeholder-gray-400",rows:"2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Training Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];g((e=>({...e,image:t})))},className:"mt-1 p-2 block w-full rounded-md border border-gray-600 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 bg-gray-800 text-white"}),u.image&&e.jsxs("p",{className:"mt-1 text-sm text-gray-300",children:["Selected: ",u.image.name]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:C,className:"px-6 py-3 border-2 border-gray-600 text-white rounded-lg hover:bg-gray-600 transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 text-black rounded-lg hover:from-yellow-600 hover:to-yellow-700 transition-all font-semibold shadow-lg disabled:opacity-50",children:o?"Scheduling...":"Schedule Training"})]})]})})]}),e.jsxs("div",{className:"bg-gray-700 rounded-2xl shadow-xl border border-gray-600 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 px-6 py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-2 md:mb-0",children:"Upcoming Training Sessions"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>p(!0),className:"bg-black text-yellow-500 py-2 px-4 rounded-lg hover:bg-gray-800 transition-all font-semibold w-full sm:w-auto",disabled:h||0===n.length,children:"Schedule New Training"}),e.jsx("button",{onClick:N,className:"bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition-all font-semibold w-full sm:w-auto",disabled:o,children:o?"Refreshing...":"Refresh"})]})]})}),e.jsx("div",{className:"p-6",children:o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-yellow-500 border-t-transparent"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Image"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Training ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Trainer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Capacity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-700 divide-y divide-gray-600",children:i.length>0?i.map((t=>e.jsxs("tr",{className:"hover:bg-gray-600 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:y.has(t.id)?e.jsx("div",{className:"h-12 w-12 bg-gray-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-yellow-400",children:"🏋️"})}):e.jsx("img",{src:j(t),alt:t.type,className:"h-12 w-12 object-cover rounded",onError:()=>w(t.id)})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-white",children:["#",t.id]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-yellow-500 text-black rounded-full capitalize",children:t.type})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-300",children:t.trainer_name||"TBA"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-300",children:S(t.datetime)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-300",children:T(t.duration)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-300",children:t.capacity||"—"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>k(t.id),className:"text-red-400 hover:text-red-300 font-semibold",children:"Cancel"})})]},t.id))):e.jsx("tr",{children:e.jsxs("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-300",children:[e.jsx("div",{className:"text-4xl text-yellow-400 mb-2",children:"📅"}),"No training sessions scheduled"]})})})]})}),e.jsx("div",{className:"md:hidden",children:i.length>0?e.jsx("div",{className:"space-y-4",children:i.map((t=>e.jsxs("div",{className:"bg-gradient-to-r from-gray-700 to-gray-600 border border-gray-500 rounded-xl p-3 shadow-lg",children:[t.image&&!y.has(t.id)?e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:j(t),alt:t.type,className:"w-full h-32 object-cover rounded",onError:()=>w(t.id)})}):y.has(t.id)?e.jsx("div",{className:"mb-2 w-full h-32 bg-gray-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-400 text-2xl",children:"🏋️"})}):null,e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-semibold text-white",children:["#",t.id," - ",t.type]}),e.jsx("button",{onClick:()=>k(t.id),className:"text-red-400 hover:text-red-300 font-semibold text-sm",children:"Cancel"})]}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Trainer:"})," ",e.jsx("span",{className:"font-medium text-white",children:t.trainer_name||"TBA"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Date:"})," ",e.jsx("span",{className:"font-medium text-white",children:S(t.datetime)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Duration:"})," ",e.jsx("span",{className:"font-medium text-white",children:T(t.duration)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Capacity:"})," ",e.jsx("span",{className:"font-medium text-white",children:t.capacity||"—"})]})]})]},t.id)))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl text-yellow-400 mb-2",children:"📅"}),e.jsx("p",{className:"text-gray-300",children:"No training sessions scheduled"})]})})]})})]})]})})]})}export{i as default};
